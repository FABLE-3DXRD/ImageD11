
from __future__ import print_function, division
import pylab as pl, numpy as np


# classical electron radius
re = 2.83e-15 # m
# densities
rho_be = 1.845 # g/cm3
rho_si = 2.32  # g/cm3
rho_al = 2.6941 # g/cm3
# atomic weights
aw_be = 9.01218  # g/mol
aw_si = 28.08550 # g/mol
aw_al = 26.9815  # g/mol

avogadro = 6.0221409e23
# number densities (m3)
na_si = 1e6 * rho_si / aw_si * avogadro
na_be = 1e6 * rho_be / aw_be * avogadro
na_al = 1e6 * rho_al / aw_al * avogadro

# electron densities
ne_si = 14 * na_si
ne_be =  5 * na_be
ne_al = 13 * na_al

#print("na_si=",na_si)

# Form factors f' , f" from
# https://physics.nist.gov/cgi-bin/ffast/ffast.pl?Z=13&Formula=&gtype=4&range=S&lower=5&upper=140&density=&frames=no
Esi,f1si,f2si = np.array( [ [float(v) for v in line.split()[:3] ] for line in 
"""5.295467E+00  1.43830E+01  7.0743E-01  2.0016E+02  1.2613E+00  2.0142E+02  1.859E+02  2.341E-01
5.660855E+00  1.43657E+01  6.2644E-01  1.6580E+02  1.1967E+00  1.6700E+02  1.541E+02  2.190E-01
6.051453E+00  1.43470E+01  5.5475E-01  1.3735E+02  1.1336E+00  1.3848E+02  1.276E+02  2.049E-01
6.469004E+00  1.43275E+01  4.9128E-01  1.1379E+02  1.0722E+00  1.1486E+02  1.058E+02  1.917E-01
6.915365E+00  1.43080E+01  4.3509E-01  9.4267E+01  1.0128E+00  9.5280E+01  8.763E+01  1.793E-01
7.392525E+00  1.42890E+01  3.8534E-01  7.8099E+01  9.5551E-01  7.9055E+01  7.261E+01  1.677E-01
7.902609E+00  1.42709E+01  3.4129E-01  6.4707E+01  9.0049E-01  6.5607E+01  6.016E+01  1.569E-01
8.447890E+00  1.42537E+01  3.0059E-01  5.3312E+01  8.4782E-01  5.4160E+01  4.955E+01  1.468E-01
9.030794E+00  1.42373E+01  2.6409E-01  4.3815E+01  7.9760E-01  4.4613E+01  4.070E+01  1.373E-01
9.653919E+00  1.42193E+01  2.3060E-01  3.5789E+01  7.4986E-01  3.6539E+01  3.325E+01  1.284E-01
1.032004E+01  1.42018E+01  2.0136E-01  2.9233E+01  7.0464E-01  2.9938E+01  2.716E+01  1.201E-01
1.103212E+01  1.41850E+01  1.7583E-01  2.3879E+01  6.6193E-01  2.4541E+01  2.219E+01  1.124E-01
1.179334E+01  1.41691E+01  1.5354E-01  1.9507E+01  6.2172E-01  2.0129E+01  1.813E+01  1.051E-01
1.260708E+01  1.41542E+01  1.3408E-01  1.5935E+01  5.8398E-01  1.6519E+01  1.481E+01  9.834E-02
1.347697E+01  1.41404E+01  1.1709E-01  1.3017E+01  5.4864E-01  1.3566E+01  1.210E+01  9.200E-02
1.440688E+01  1.41275E+01  1.0225E-01  1.0634E+01  5.1565E-01  1.1150E+01  9.884E+00  8.606E-02
1.540095E+01  1.41156E+01  8.9301E-02  8.6877E+00  4.8493E-01  9.1726E+00  8.074E+00  8.050E-02
1.646362E+01  1.41047E+01  7.7990E-02  7.0976E+00  4.5640E-01  7.5540E+00  6.596E+00  7.531E-02
1.759961E+01  1.40947E+01  6.8113E-02  5.7986E+00  4.2996E-01  6.2286E+00  5.389E+00  7.045E-02
1.881398E+01  1.40856E+01  5.9487E-02  4.7374E+00  4.0551E-01  5.1429E+00  4.402E+00  6.590E-02
2.011215E+01  1.40772E+01  5.1955E-02  3.8705E+00  3.8295E-01  4.2534E+00  3.596E+00  6.165E-02
2.149988E+01  1.40696E+01  4.5377E-02  3.1623E+00  3.6217E-01  3.5245E+00  2.938E+00  5.767E-02
2.298338E+01  1.40628E+01  3.9633E-02  2.5837E+00  3.4306E-01  2.9268E+00  2.400E+00  5.395E-02
2.456923E+01  1.40566E+01  3.4616E-02  2.1110E+00  3.2552E-01  2.4365E+00  1.961E+00  5.046E-02
2.626450E+01  1.40511E+01  3.0235E-02  1.7248E+00  3.0943E-01  2.0342E+00  1.602E+00  4.721E-02
2.807676E+01  1.40462E+01  2.6276E-02  1.4022E+00  2.9470E-01  1.6969E+00  1.302E+00  4.416E-02
3.001405E+01  1.40415E+01  2.2797E-02  1.1380E+00  2.8122E-01  1.4192E+00  1.057E+00  4.131E-02
3.208502E+01  1.40372E+01  1.9779E-02  9.2365E-01  2.6889E-01  1.1925E+00  8.581E-01  3.864E-02
3.429889E+01  1.40333E+01  1.7161E-02  7.4966E-01  2.5761E-01  1.0073E+00  6.965E-01  3.615E-02
3.666551E+01  1.40298E+01  1.4890E-02  6.0846E-01  2.4729E-01  8.5575E-01  5.654E-01  3.381E-02
3.919543E+01  1.40267E+01  1.2919E-02  4.9385E-01  2.3785E-01  7.3170E-01  4.590E-01  3.163E-02
4.189992E+01  1.40239E+01  1.1160E-02  3.9906E-01  2.2920E-01  6.2826E-01  3.708E-01  2.959E-02
4.479101E+01  1.40213E+01  9.6400E-03  3.2246E-01  2.2126E-01  5.4372E-01  2.995E-01  2.768E-02
4.788159E+01  1.40191E+01  8.3272E-03  2.6057E-01  2.1397E-01  4.7454E-01  2.420E-01  2.589E-02
5.118542E+01  1.40170E+01  7.1932E-03  2.1056E-01  2.0725E-01  4.1781E-01  1.955E-01  2.422E-02
5.471721E+01  1.40151E+01  6.2137E-03  1.7015E-01  2.0104E-01  3.7119E-01  1.579E-01  2.266E-02
5.849270E+01  1.40135E+01  5.3676E-03  1.3749E-01  1.9529E-01  3.3278E-01  1.276E-01  2.120E-02
6.252870E+01  1.40120E+01  4.6367E-03  1.1110E-01  1.8993E-01  3.0103E-01  1.031E-01  1.983E-02
6.684318E+01  1.40107E+01  4.0054E-03  8.9782E-02  1.8493E-01  2.7471E-01  8.327E-02  1.855E-02
7.145536E+01  1.40095E+01  3.4605E-03  7.2561E-02  1.8024E-01  2.5280E-01  6.727E-02  1.735E-02
7.638578E+01  1.40084E+01  2.9899E-03  5.8646E-02  1.7582E-01  2.3447E-01  5.435E-02  1.623E-02
8.165640E+01  1.40075E+01  2.5832E-03  4.7399E-02  1.7163E-01  2.1903E-01  4.391E-02  1.518E-02
8.729069E+01  1.40066E+01  2.2319E-03  3.8309E-02  1.6764E-01  2.0595E-01  3.547E-02  1.420E-02
9.331374E+01  1.40059E+01  1.9284E-03  3.0963E-02  1.6382E-01  1.9478E-01  2.866E-02  1.329E-02
9.975239E+01  1.40052E+01  1.6662E-03  2.5026E-02  1.6015E-01  1.8518E-01  2.315E-02  1.243E-02
1.066353E+02  1.40046E+01  1.4396E-03  2.0227E-02  1.5661E-01  1.7684E-01  1.870E-02  1.163E-02
1.139931E+02  1.40041E+01  1.2438E-03  1.6349E-02  1.5317E-01  1.6952E-01  1.511E-02  1.088E-02
1.218587E+02  1.40036E+01  1.0747E-03  1.3214E-02  1.4983E-01  1.6304E-01  1.221E-02  1.017E-02
1.302669E+02  1.40032E+01  9.2859E-04  1.0680E-02  1.4655E-01  1.5723E-01  9.861E-03  9.518E-03
1.392553E+02  1.40029E+01  8.0234E-04  8.6327E-03  1.4335E-01  1.5198E-01  7.967E-03  8.903E-03""".split("\n")]).T

Ebe,f1be,f2be = np.array( [ [float(v) for v in line.split()[:3] ] for line in 
"""5.295467E+00  4.00923E+00  3.4651E-03  3.0554E+00  3.0111E-01  3.3565E+00  2.961E+00  2.341E-01
5.660855E+00  4.00820E+00  2.9861E-03  2.4630E+00  2.9098E-01  2.7540E+00  2.387E+00  2.190E-01
6.051453E+00  4.00729E+00  2.5732E-03  1.9855E+00  2.8130E-01  2.2668E+00  1.924E+00  2.049E-01
6.469004E+00  4.00647E+00  2.2175E-03  1.6006E+00  2.7209E-01  1.8727E+00  1.551E+00  1.917E-01
6.915365E+00  4.00574E+00  1.9109E-03  1.2903E+00  2.6336E-01  1.5537E+00  1.250E+00  1.793E-01
7.392525E+00  4.00510E+00  1.6467E-03  1.0401E+00  2.5511E-01  1.2952E+00  1.008E+00  1.677E-01
7.902609E+00  4.00452E+00  1.4191E-03  8.3845E-01  2.4735E-01  1.0858E+00  8.126E-01  1.569E-01
8.447890E+00  4.00401E+00  1.2229E-03  6.7590E-01  2.4006E-01  9.1596E-01  6.550E-01  1.468E-01
9.030794E+00  4.00356E+00  1.0525E-03  5.4417E-01  2.3323E-01  7.7740E-01  5.274E-01  1.373E-01
9.653919E+00  4.00316E+00  9.0177E-04  4.3616E-01  2.2687E-01  6.6303E-01  4.226E-01  1.284E-01
1.032004E+01  4.00280E+00  7.7264E-04  3.4958E-01  2.2094E-01  5.7052E-01  3.387E-01  1.201E-01
1.103212E+01  4.00248E+00  6.6200E-04  2.8019E-01  2.1543E-01  4.9562E-01  2.714E-01  1.124E-01
1.179334E+01  4.00219E+00  5.6721E-04  2.2457E-01  2.1032E-01  4.3489E-01  2.175E-01  1.051E-01
1.260708E+01  4.00194E+00  4.8599E-04  1.8000E-01  2.0559E-01  3.8559E-01  1.743E-01  9.834E-02
1.347697E+01  4.00171E+00  4.1640E-04  1.4427E-01  2.0122E-01  3.4549E-01  1.397E-01  9.200E-02
1.440688E+01  4.00151E+00  3.5677E-04  1.1563E-01  1.9717E-01  3.1280E-01  1.120E-01  8.606E-02
1.540095E+01  4.00134E+00  3.0569E-04  9.2679E-02  1.9343E-01  2.8611E-01  8.973E-02  8.050E-02
1.646362E+01  4.00118E+00  2.6192E-04  7.4282E-02  1.8997E-01  2.6425E-01  7.191E-02  7.531E-02
1.759961E+01  4.00104E+00  2.2441E-04  5.9538E-02  1.8677E-01  2.4631E-01  5.763E-02  7.045E-02
1.881398E+01  4.00092E+00  1.9228E-04  4.7720E-02  1.8379E-01  2.3151E-01  4.619E-02  6.590E-02
2.011215E+01  4.00081E+00  1.6475E-04  3.8248E-02  1.8102E-01  2.1927E-01  3.701E-02  6.165E-02
2.149988E+01  4.00072E+00  1.4116E-04  3.0656E-02  1.7844E-01  2.0910E-01  2.966E-02  5.767E-02
2.298338E+01  4.00063E+00  1.2094E-04  2.4571E-02  1.7602E-01  2.0059E-01  2.377E-02  5.395E-02
2.456923E+01  4.00056E+00  1.0363E-04  1.9694E-02  1.7373E-01  1.9342E-01  1.905E-02  5.046E-02
2.626450E+01  4.00049E+00  8.8788E-05  1.5785E-02  1.7157E-01  1.8736E-01  1.527E-02  4.721E-02
2.807676E+01  4.00043E+00  7.5940E-05  1.2629E-02  1.6951E-01  1.8214E-01  1.221E-02  4.416E-02
3.001405E+01  4.00038E+00  6.4915E-05  1.0099E-02  1.6752E-01  1.7762E-01  9.764E-03  4.131E-02
3.208502E+01  4.00034E+00  5.5490E-05  8.0753E-03  1.6561E-01  1.7369E-01  7.806E-03  3.864E-02
3.429889E+01  4.00030E+00  4.7433E-05  6.4573E-03  1.6374E-01  1.7020E-01  6.240E-03  3.615E-02
3.666551E+01  4.00026E+00  4.0546E-05  5.1635E-03  1.6192E-01  1.6708E-01  4.989E-03  3.381E-02
3.919543E+01  4.00023E+00  3.4660E-05  4.1289E-03  1.6011E-01  1.6424E-01  3.988E-03  3.163E-02
4.189992E+01  4.00020E+00  2.9628E-05  3.3017E-03  1.5833E-01  1.6163E-01  3.188E-03  2.959E-02
4.479101E+01  4.00018E+00  2.5326E-05  2.6401E-03  1.5654E-01  1.5918E-01  2.549E-03  2.768E-02
4.788159E+01  4.00016E+00  2.1649E-05  2.1112E-03  1.5475E-01  1.5686E-01  2.038E-03  2.589E-02
5.118542E+01  4.00014E+00  1.8512E-05  1.6887E-03  1.5295E-01  1.5464E-01  1.629E-03  2.422E-02
5.471721E+01  4.00012E+00  1.5845E-05  1.3522E-03  1.5113E-01  1.5248E-01  1.304E-03  2.266E-02
5.849270E+01  4.00011E+00  1.3563E-05  1.0827E-03  1.4928E-01  1.5036E-01  1.044E-03  2.120E-02
6.252870E+01  4.00009E+00  1.1610E-05  8.6693E-04  1.4741E-01  1.4828E-01  8.360E-04  1.983E-02
6.684318E+01  4.00008E+00  9.9374E-06  6.9417E-04  1.4550E-01  1.4619E-01  6.692E-04  1.855E-02
7.145536E+01  4.00007E+00  8.5061E-06  5.5584E-04  1.4357E-01  1.4413E-01  5.358E-04  1.735E-02
7.638578E+01  4.00006E+00  7.2810E-06  4.4507E-04  1.4159E-01  1.4204E-01  4.289E-04  1.623E-02
8.165640E+01  4.00006E+00  6.2323E-06  3.5638E-04  1.3958E-01  1.3994E-01  3.434E-04  1.518E-02
8.729069E+01  4.00005E+00  5.3347E-06  2.8536E-04  1.3753E-01  1.3782E-01  2.749E-04  1.420E-02
9.331374E+01  4.00004E+00  4.5664E-06  2.2849E-04  1.3544E-01  1.3567E-01  2.201E-04  1.329E-02
9.975239E+01  4.00004E+00  3.9087E-06  1.8296E-04  1.3332E-01  1.3350E-01  1.762E-04  1.243E-02
1.066353E+02  4.00003E+00  3.3457E-06  1.4650E-04  1.3116E-01  1.3131E-01  1.410E-04  1.163E-02
1.139931E+02  4.00003E+00  2.8639E-06  1.1731E-04  1.2896E-01  1.2908E-01  1.129E-04  1.088E-02
1.218587E+02  4.00003E+00  2.4514E-06  9.3931E-05  1.2674E-01  1.2683E-01  9.038E-05  1.017E-02
1.302669E+02  4.00002E+00  2.0984E-06  7.5214E-05  1.2448E-01  1.2456E-01  7.235E-05  9.518E-03
1.392553E+02  4.00002E+00  1.7962E-06  6.0226E-05  1.2220E-01  1.2226E-01  5.792E-05  8.903E-03""".split("\n")]).T


Eal,f1al,f2al = np.array( [ [float(v) for v in line.split()[:3] ] for line in 
"""5.295467E+00  1.33392E+01  5.3446E-01  1.5741E+02  1.1376E+00  1.5855E+02  1.470E+02  2.341E-01
5.660855E+00  1.33198E+01  4.7341E-01  1.3043E+02  1.0796E+00  1.3151E+02  1.218E+02  2.190E-01
6.051453E+00  1.33004E+01  4.1935E-01  1.0808E+02  1.0229E+00  1.0910E+02  1.010E+02  2.049E-01
6.469004E+00  1.32816E+01  3.7148E-01  8.9558E+01  9.6791E-01  9.0526E+01  8.370E+01  1.917E-01
6.915365E+00  1.32637E+01  3.2822E-01  7.4022E+01  9.1472E-01  7.4937E+01  6.919E+01  1.793E-01
7.392525E+00  1.32456E+01  2.8857E-01  6.0881E+01  8.6348E-01  6.1744E+01  5.688E+01  1.677E-01
7.902609E+00  1.32277E+01  2.5373E-01  5.0073E+01  8.1431E-01  5.0887E+01  4.677E+01  1.569E-01
8.447890E+00  1.32105E+01  2.2309E-01  4.1186E+01  7.6728E-01  4.1953E+01  3.845E+01  1.468E-01
9.030794E+00  1.31945E+01  1.9580E-01  3.3814E+01  7.2247E-01  3.4536E+01  3.156E+01  1.373E-01
9.653919E+00  1.31795E+01  1.7070E-01  2.7577E+01  6.7991E-01  2.8257E+01  2.574E+01  1.284E-01
1.032004E+01  1.31646E+01  1.4882E-01  2.2491E+01  6.3961E-01  2.3131E+01  2.099E+01  1.201E-01
1.103212E+01  1.31503E+01  1.2975E-01  1.8343E+01  6.0158E-01  1.8945E+01  1.712E+01  1.124E-01
1.179334E+01  1.31369E+01  1.1313E-01  1.4961E+01  5.6579E-01  1.5527E+01  1.397E+01  1.051E-01
1.260708E+01  1.31243E+01  9.8639E-02  1.2202E+01  5.3222E-01  1.2734E+01  1.139E+01  9.834E-02
1.347697E+01  1.31128E+01  8.6005E-02  9.9528E+00  5.0080E-01  1.0454E+01  9.290E+00  9.200E-02
1.440688E+01  1.31021E+01  7.4990E-02  8.1180E+00  4.7149E-01  8.5895E+00  7.577E+00  8.606E-02
1.540095E+01  1.30923E+01  6.5387E-02  6.6216E+00  4.4420E-01  7.0658E+00  6.180E+00  8.050E-02
1.646362E+01  1.30833E+01  5.7015E-02  5.4010E+00  4.1887E-01  5.8199E+00  5.041E+00  7.531E-02
1.759961E+01  1.30752E+01  4.9716E-02  4.4056E+00  3.9539E-01  4.8010E+00  4.111E+00  7.045E-02
1.881398E+01  1.30677E+01  4.3351E-02  3.5936E+00  3.7369E-01  3.9673E+00  3.353E+00  6.590E-02
2.011215E+01  1.30610E+01  3.7802E-02  2.9314E+00  3.5368E-01  3.2851E+00  2.735E+00  6.165E-02
2.149988E+01  1.30548E+01  3.2964E-02  2.3912E+00  3.3524E-01  2.7264E+00  2.231E+00  5.767E-02
2.298338E+01  1.30493E+01  2.8745E-02  1.9506E+00  3.1829E-01  2.2689E+00  1.819E+00  5.395E-02
2.456923E+01  1.30443E+01  2.5066E-02  1.5912E+00  3.0273E-01  1.8939E+00  1.484E+00  5.046E-02
2.626450E+01  1.30397E+01  2.1859E-02  1.2980E+00  2.8846E-01  1.5865E+00  1.210E+00  4.721E-02
2.807676E+01  1.30358E+01  1.8978E-02  1.0542E+00  2.7539E-01  1.3296E+00  9.830E-01  4.416E-02
3.001405E+01  1.30321E+01  1.6453E-02  8.5493E-01  2.6343E-01  1.1184E+00  7.973E-01  4.131E-02
3.208502E+01  1.30288E+01  1.4264E-02  6.9335E-01  2.5248E-01  9.4583E-01  6.466E-01  3.864E-02
3.429889E+01  1.30258E+01  1.2344E-02  5.6128E-01  2.4246E-01  8.0374E-01  5.234E-01  3.615E-02
3.666551E+01  1.30231E+01  1.0660E-02  4.5343E-01  2.3329E-01  6.8672E-01  4.227E-01  3.381E-02
3.919543E+01  1.30206E+01  9.2057E-03  3.6630E-01  2.2489E-01  5.9119E-01  3.414E-01  3.163E-02
4.189992E+01  1.30184E+01  7.9499E-03  2.9591E-01  2.1718E-01  5.1309E-01  2.757E-01  2.959E-02
4.479101E+01  1.30164E+01  6.8656E-03  2.3905E-01  2.1010E-01  4.4915E-01  2.227E-01  2.768E-02
4.788159E+01  1.30146E+01  5.9291E-03  1.9312E-01  2.0359E-01  3.9671E-01  1.798E-01  2.589E-02
5.118542E+01  1.30130E+01  5.1204E-03  1.5602E-01  1.9757E-01  3.5359E-01  1.452E-01  2.422E-02
5.471721E+01  1.30116E+01  4.4218E-03  1.2603E-01  1.9200E-01  3.1803E-01  1.173E-01  2.266E-02
5.849270E+01  1.30103E+01  3.8180E-03  1.0180E-01  1.8683E-01  2.8863E-01  9.474E-02  2.120E-02
6.252870E+01  1.30091E+01  3.2967E-03  8.2227E-02  1.8200E-01  2.6423E-01  7.652E-02  1.983E-02
6.684318E+01  1.30081E+01  2.8466E-03  6.6417E-02  1.7747E-01  2.4389E-01  6.180E-02  1.855E-02
7.145536E+01  1.30072E+01  2.4579E-03  5.3647E-02  1.7321E-01  2.2686E-01  4.991E-02  1.735E-02
7.638578E+01  1.30064E+01  2.1224E-03  4.3333E-02  1.6918E-01  2.1251E-01  4.031E-02  1.623E-02
8.165640E+01  1.30057E+01  1.8326E-03  3.5002E-02  1.6534E-01  2.0034E-01  3.256E-02  1.518E-02
8.729069E+01  1.30050E+01  1.5824E-03  2.8272E-02  1.6168E-01  1.8995E-01  2.629E-02  1.420E-02
9.331374E+01  1.30045E+01  1.3664E-03  2.2837E-02  1.5816E-01  1.8100E-01  2.124E-02  1.329E-02
9.975239E+01  1.30040E+01  1.1798E-03  1.8447E-02  1.5476E-01  1.7321E-01  1.715E-02  1.243E-02
1.066353E+02  1.30035E+01  1.0188E-03  1.4900E-02  1.5146E-01  1.6636E-01  1.385E-02  1.163E-02
1.139931E+02  1.30031E+01  8.7971E-04  1.2036E-02  1.4824E-01  1.6028E-01  1.119E-02  1.088E-02
1.218587E+02  1.30027E+01  7.5962E-04  9.7220E-03  1.4510E-01  1.5482E-01  9.035E-03  1.017E-02
1.302669E+02  1.30024E+01  6.5593E-04  7.8530E-03  1.4202E-01  1.4987E-01  7.297E-03  9.518E-03
1.392553E+02  1.30022E+01  5.6639E-04  6.3434E-03  1.3898E-01  1.4532E-01  5.893E-03  8.903E-03""".split("\n")]).T

# f = R / ( 2 . N . delta)
# 1/f = 1/s1 + 1/s2

X_IVT = 31.5
X_PINHOLE = 49.1
X_IAT = 91.5
X_NSCOPE = 96.0
#          1 2  3  4  5   6    7  8   9   10
N_SI  = [ 12,28,52,80,116,160,208,264,324,392 ]
N_BE  = [1,2,4,8,16,32]
N_AL  = [32, 64]
R_SI  = 12.5e-6
R_BE  = 0.2e-3
R_AL  = 0.2e-3

# Linear attenuation coefficient mu
#     mu = 4 pi beta / lambda


wsi = 12.39842e-10 / Esi
wal = 12.39842e-10 / Eal
wbe = 12.39842e-10 / Ebe
delta_si = na_si * re * wsi * wsi * f1si / 2 / np.pi
beta_si =  na_si * re * wsi * wsi * f2si / 2 / np.pi
mu_si   =  na_si * re * wsi * f2si * 2
delta_al = na_al * re * wal * wal * f1al / 2 / np.pi
beta_al =  na_al * re * wal * wal * f2al / 2 / np.pi
mu_al   =  na_al * re * wal * f2al * 2 
delta_be = na_be * re * wbe * wbe * f1be / 2 / np.pi
beta_be =  na_be * re * wbe * wbe * f2be / 2 / np.pi
mu_be   =  na_be * re * wbe * f2be * 2 

delta_si2 = re * wsi * wsi * ne_si / 2 / np.pi


if 1:
    pl.plot( Esi, delta_si, "+-")
    pl.plot( Esi, delta_si2, "+-")
    pl.show()
    pl.plot( Esi, beta_si, "+-")
    pl.plot( Eal, delta_al, "+-")
    pl.plot( Eal, beta_al, "+-")
    pl.plot( Ebe, delta_be, "+-")
    pl.plot( Ebe, beta_be, "+-")
    pl.show()


# approximately : delta = r0 . w^2 . ne / 2 / pi     ne - electron density. We can try this!
#  n  =  1  - delta  + i.beta
#  n  = c / v  ... ratio of speeds.

# Focussing condition is that f*f + dx*dx = pathlength, where dx is off axis distance
#  ... this is where the parabola comes from

# parabolic lenses:
#    thickness(x)  = a*x*x
# circles, center at R:
#    x^2 + (y-R)^2 = R^2
#    x^2 + y^2 + R^2 - 2*Ry = R^2
#    x^2 + y^2 = 2*Ry
# ... x>>y : x^2 = 2Ry
# so Y = x^2/(2R)
#x = np.linspace( -.5e-3, .5e-3, 100)
x = np.linspace( -25e-6, 25e-6, 100)
#pl.plot( 1e6*x, 1e6*x*x/(2*R_SI), "-" )
E = 40 
mu_si_40 = np.interp( E, Esi, mu_si )
for nsi in N_SI:
    total_thickness = nsi * 2 * x*x/(2*R_SI)
    transmitted = np.exp( -mu_si_40 * total_thickness )
    pl.plot( x, transmitted, "-")

pl.show()
