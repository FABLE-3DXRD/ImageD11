
<!doctype html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module ImageD11.gv_general</title>
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong><a href="ImageD11.html"><font color="#ffffff">ImageD11</font></a>.gv_general</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:///C|/python25/lib/site-packages/imaged11/gv_general.py">c:\python25\lib\site-packages\imaged11\gv_general.py</a></font></td></tr></table>
    <p><tt>Find&nbsp;a&nbsp;generalised&nbsp;way&nbsp;to&nbsp;compute&nbsp;g-vectors&nbsp;backwards&nbsp;and&nbsp;forwards</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#fffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="numpy.oldnumeric.linear_algebra.html">numpy.oldnumeric.linear_algebra</a><br>
</td><td width="25%" valign=top><a href="logging.html">logging</a><br>
</td><td width="25%" valign=top><a href="math.html">math</a><br>
</td><td width="25%" valign=top><a href="numpy.oldnumeric.html">numpy.oldnumeric</a><br>
</td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ee77aa">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Classes</strong></big></font></td></tr>
    
<tr><td bgcolor="#ee77aa"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl>
<dt><font face="helvetica, arial"><a href="ImageD11.gv_general.html#rotation_axis">rotation_axis</a>
</font></dt></dl>
 <p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#ffc8d8">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#000000" face="helvetica, arial"><a name="rotation_axis">class <strong>rotation_axis</strong></a></font></td></tr>
    
<tr bgcolor="#ffc8d8"><td rowspan=2><tt>&nbsp;&nbsp;&nbsp;</tt></td>
<td colspan=2><tt>Represents&nbsp;an&nbsp;axis&nbsp;-&nbsp;so&nbsp;far&nbsp;includes:<br>
&nbsp;&nbsp;&nbsp;&nbsp;axis/angle<br>
&nbsp;&nbsp;&nbsp;&nbsp;matrix&nbsp;(direction&nbsp;cosines)<br>
&nbsp;<br>
potentially&nbsp;can&nbsp;add&nbsp;quaternions&nbsp;and&nbsp;euler&nbsp;etc&nbsp;later?<br>&nbsp;</tt></td></tr>
<tr><td>&nbsp;</td>
<td width="100%">Methods defined here:<br>
<dl><dt><a name="rotation_axis-__init__"><strong>__init__</strong></a>(self, direction, angle<font color="#909090">=0.0</font>)</dt><dd><tt>direction&nbsp;is&nbsp;the&nbsp;rotation&nbsp;direction<br>
angle&nbsp;is&nbsp;the&nbsp;angle&nbsp;of&nbsp;rotation&nbsp;(degrees)</tt></dd></dl>

<dl><dt><a name="rotation_axis-rotate_vectors"><strong>rotate_vectors</strong></a>(self, vectors, angles<font color="#909090">=None</font>)</dt><dd><tt>Given&nbsp;a&nbsp;list&nbsp;of&nbsp;vectors,&nbsp;rotate&nbsp;them&nbsp;to&nbsp;new&nbsp;ones<br>
Angle&nbsp;is&nbsp;either&nbsp;self.<strong>angle</strong>,&nbsp;or&nbsp;1&nbsp;per&nbsp;vector,&nbsp;in&nbsp;degrees<br>
&nbsp;<br>
<a href="http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/rotation.html">http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/rotation.html</a><br>
p'&nbsp;=&nbsp;a&nbsp;.&nbsp;p&nbsp;a&nbsp;+&nbsp;(p&nbsp;-&nbsp;a&nbsp;.&nbsp;p&nbsp;a)&nbsp;cos&nbsp;q&nbsp;+&nbsp;a&nbsp;*&nbsp;p&nbsp;sin&nbsp;q<br>
&nbsp;&nbsp;&nbsp;=&nbsp;p&nbsp;cos&nbsp;q&nbsp;+&nbsp;a&nbsp;.&nbsp;p&nbsp;a&nbsp;(1-cos&nbsp;q)&nbsp;+&nbsp;a&nbsp;*&nbsp;p&nbsp;sin&nbsp;q&nbsp;<br>
&nbsp;&nbsp;&nbsp;point&nbsp;p,&nbsp;axis&nbsp;a,&nbsp;angle&nbsp;q&nbsp;<br>
&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;<br>
<a href="http://mathworld.wolfram.com/RotationFormula.html">http://mathworld.wolfram.com/RotationFormula.html</a><br>
r'&nbsp;=&nbsp;r&nbsp;cos(t)&nbsp;+&nbsp;n(n.r)(1-cos(t))&nbsp;+&nbsp;rxn&nbsp;sin(t)</tt></dd></dl>

<dl><dt><a name="rotation_axis-rotate_vectors_inverse"><strong>rotate_vectors_inverse</strong></a>(self, vectors, angles<font color="#909090">=None</font>)</dt><dd><tt>Same&nbsp;as&nbsp;rotate&nbsp;vectors,&nbsp;but&nbsp;opposing&nbsp;sense</tt></dd></dl>

<dl><dt><a name="rotation_axis-to_matrix"><strong>to_matrix</strong></a>(self)</dt><dd><tt>Returns&nbsp;a&nbsp;3x3&nbsp;rotation&nbsp;matrix<br>
R&nbsp;=&nbsp;I3cos(t)&nbsp;+&nbsp;ww^T&nbsp;(1-cos(t))&nbsp;-&nbsp;W&nbsp;sin(t)<br>
t&nbsp;=&nbsp;angle<br>
W&nbsp;=&nbsp;vector&nbsp;with&nbsp;hat&nbsp;operator&nbsp;=&nbsp;[&nbsp;0&nbsp;&nbsp;-wz&nbsp;&nbsp;wy&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wz&nbsp;&nbsp;0&nbsp;&nbsp;-wx<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-wy&nbsp;&nbsp;wx&nbsp;&nbsp;0&nbsp;&nbsp;]</tt></dd></dl>

</td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-axis_from_matrix"><strong>axis_from_matrix</strong></a>(m)</dt><dd><tt>Factory&nbsp;method&nbsp;to&nbsp;create&nbsp;a&nbsp;<a href="#rotation_axis">rotation_axis</a>&nbsp;object&nbsp;from&nbsp;a&nbsp;direction&nbsp;cosine&nbsp;matrix<br>
<a href="http://en.wikipedia.org/wiki/Rotation_representation_%28mathematics%29">http://en.wikipedia.org/wiki/Rotation_representation_%28mathematics%29</a></tt></dd></dl>
 <dl><dt><a name="-g_to_k"><strong>g_to_k</strong></a>(g, wavelength, axis<font color="#909090">=array([ 0.,  0.,  1.])</font>, pre<font color="#909090">=None</font>, post<font color="#909090">=None</font>)</dt><dd><tt>Get&nbsp;the&nbsp;k&nbsp;and&nbsp;angles&nbsp;given&nbsp;the&nbsp;g&nbsp;in&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;=&nbsp;pre&nbsp;.&nbsp;rot(axis,&nbsp;angle)&nbsp;.&nbsp;post&nbsp;.&nbsp;k<br>
...where&nbsp;k&nbsp;will&nbsp;satisfy&nbsp;the&nbsp;Laue&nbsp;equations<br>
&nbsp;<br>
The&nbsp;recipe&nbsp;is:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Find&nbsp;the&nbsp;components&nbsp;of&nbsp;g&nbsp;along&nbsp;and&nbsp;perpendicular&nbsp;to&nbsp;the&nbsp;rotation&nbsp;axis<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;co-ords&nbsp;are&nbsp;a0&nbsp;=&nbsp;axis,&nbsp;a1&nbsp;=&nbsp;axis&nbsp;x&nbsp;g,&nbsp;a2&nbsp;=&nbsp;a1&nbsp;x&nbsp;axis&nbsp;=&nbsp;(&nbsp;axis&nbsp;x&nbsp;g&nbsp;)&nbsp;x&nbsp;axis<br>
&nbsp;&nbsp;&nbsp;&nbsp;Rotated&nbsp;vector&nbsp;will&nbsp;be&nbsp;a0&nbsp;+&nbsp;a1&nbsp;sin(angle)&nbsp;+&nbsp;a2&nbsp;cos(angle)<br>
&nbsp;&nbsp;&nbsp;&nbsp;Laue&nbsp;condition&nbsp;says&nbsp;that&nbsp;[incident&nbsp;beam].[k]&nbsp;=&nbsp;k.sin(theta)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;sin^2(theta)&nbsp;/&nbsp;lambda&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sin(t)/d&nbsp;=&nbsp;|g|.sin(t)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;|g|*|g|*lambda&nbsp;/&nbsp;2<br>
&nbsp;&nbsp;&nbsp;&nbsp;Apply&nbsp;any&nbsp;post&nbsp;rotations&nbsp;to&nbsp;the&nbsp;incident&nbsp;beam&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Apply&nbsp;any&nbsp;pre-rotations&nbsp;to&nbsp;the&nbsp;g&nbsp;vector<br>
&nbsp;&nbsp;&nbsp;&nbsp;|g|&nbsp;=&nbsp;[a0&nbsp;+&nbsp;a1&nbsp;sin(angle)&nbsp;+&nbsp;a2&nbsp;cos(angle)&nbsp;]&nbsp;.&nbsp;[incident&nbsp;beam]<br>
&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;solve&nbsp;for&nbsp;angle<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.ping.be/~ping1339/gonio.htm">http://www.ping.be/~ping1339/gonio.htm</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;sin(u)&nbsp;+&nbsp;b&nbsp;cos(u)&nbsp;=&nbsp;c<br>
&nbsp;&nbsp;&nbsp;&nbsp;let:&nbsp;tan(u')&nbsp;=&nbsp;-b/a<br>
&nbsp;&nbsp;&nbsp;&nbsp;and:&nbsp;A&nbsp;=&nbsp;a&nbsp;/&nbsp;cos(u')<br>
&nbsp;&nbsp;&nbsp;&nbsp;Finally&nbsp;you'll&nbsp;find:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.sin(u-u')&nbsp;=&nbsp;c<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.cos(pi/2&nbsp;-&nbsp;u&nbsp;-&nbsp;u')&nbsp;=&nbsp;c</tt></dd></dl>
 <dl><dt><a name="-k_to_g"><strong>k_to_g</strong></a>(k, angles, axis<font color="#909090">=&lt;ImageD11.gv_general.rotation_axis instance at 0x099FB300&gt;</font>, pre<font color="#909090">=&lt;ImageD11.gv_general.rotation_axis instance at 0x099FB3C8&gt;</font>, post<font color="#909090">=&lt;ImageD11.gv_general.rotation_axis instance at 0x099FB3C8&gt;</font>)</dt><dd><tt>Computes&nbsp;g&nbsp;=&nbsp;pre&nbsp;.&nbsp;rot(axis,&nbsp;angle)&nbsp;.&nbsp;post&nbsp;.&nbsp;k<br>
Typically&nbsp;in&nbsp;ImageD11&nbsp;pre&nbsp;=&nbsp;[wedge][chi]&nbsp;and&nbsp;post&nbsp;=&nbsp;identity</tt></dd></dl>
</td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#55aa55">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Data</strong></big></font></td></tr>
    
<tr><td bgcolor="#55aa55"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><strong>rotate_identity</strong> = &lt;ImageD11.gv_general.rotation_axis instance at 0x099FB3C8&gt;</td></tr></table>
</body></html>